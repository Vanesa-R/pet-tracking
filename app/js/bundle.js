import{initializeApp}from"firebase/app";import{getFirestore}from"@firebase/firestore";import{getAuth}from"firebase/auth";const firebaseConfig={apiKey:"AIzaSyBlbGMnS8UVk3ZUrlNDgYsX0q4jLum-aWA",authDomain:"pet-tracking-79e8a.firebaseapp.com",projectId:"pet-tracking-79e8a",storageBucket:"pet-tracking-79e8a.appspot.com",messagingSenderId:"248212976670",appId:"1:248212976670:web:8fb86899b7441a291e2a0f"},app=initializeApp(firebaseConfig),db=getFirestore(app),auth=getAuth(app);import{async}from"@firebase/util";import{createUserWithEmailAndPassword,signInWithEmailAndPassword,GoogleAuthProvider,signInWithPopup}from"firebase/auth";import{doc,setDoc,getDoc}from"firebase/firestore";forms.forEach((e=>{e.addEventListener("submit",(async t=>{if(t.preventDefault(),e.classList.contains("form__register")){let e=document.querySelector("#user__name").value,t=document.querySelector("#email__register"),n=document.querySelector("#password__register"),o=document.querySelector(".btn__submit--register");createUserWithEmailAndPassword(auth,t.value,n.value).then((()=>{const n=auth.currentUser.uid;newUserDDBB(n,e,t.value),closeModal()})).catch((e=>{"auth/email-already-in-use"==e.code?(o.setAttribute("disabled","disabled"),t.nextElementSibling.textContent="Existe un usuario registrado con esta dirección de correo electrónico"):t.nextElementSibling.textContent=""}))}if(e.classList.contains("form__login")){let e=document.querySelector("#email__login"),t=document.querySelector("#password__login"),n=document.querySelector(".btn__submit--login");signInWithEmailAndPassword(auth,e.value,t.value).then((e=>{closeModal()})).catch((o=>{n.setAttribute("disabled","disabled"),"auth/user-not-found"==o.code?e.nextElementSibling.textContent="La dirección de correo introducida no está asociada a ninguna cuenta":e.nextElementSibling.textContent="","auth/wrong-password"==o.code?t.nextElementSibling.textContent="La contraseña es incorrecta":t.nextElementSibling.textContent=""}))}}))}));let btnGoogle=document.querySelector(".btn--google");btnGoogle.addEventListener("click",(()=>{const e=new GoogleAuthProvider;signInWithPopup(auth,e).then((e=>{GoogleAuthProvider.credentialFromResult(e);const t=e.user;newUserDDBB(t.uid,t.displayName,t.email),closeModal()})).catch((e=>{console.log(e.message)}))}));const newUserDDBB=(e,t,n)=>{setDoc(doc(db,"users",e),{datos_personales:{nombre:t,email:n}})};import{signOut}from"firebase/auth";let btnLogout=document.querySelectorAll(".interaction__logout"),menuMobile=document.querySelector(".menu__primary");btnLogout.forEach((e=>{e.addEventListener("click",(t=>{signOut(auth).then((t=>{e.classList.contains("user__logged--out")&&e.classList.add("btn--enabled"),e.classList.contains("user__logged--in")&&e.classList.remove("btn--enabled"),menuMobile.classList.remove("menu--active"),btnMenuMobile.classList.remove("btn--enabled")})).catch((e=>{console.log(e)}))}))}));import{onAuthStateChanged}from"firebase/auth";let btnInteraction=document.querySelectorAll(".header .interaction .btn"),btnMenuMobile=document.querySelector(".icon__menu"),informationAppLoggedOut=document.querySelector(".information__app"),petEmpty=document.querySelector(".pet__empty");onAuthStateChanged(auth,(e=>{btnInteraction.forEach((t=>{e?(t.classList.contains("user__logged--out")&&t.classList.remove("btn--enabled"),t.classList.contains("user__logged--in")&&(window.outerWidth>=768?(t.classList.add("btn--enabled"),btnMenuMobile.classList.remove("btn--enabled")):btnMenuMobile.classList.add("btn--enabled")),location.pathname.includes("index")&&informationAppLoggedOut.classList.remove("section__fade--in"),showIconMenu()):(t.classList.contains("user__logged--out")&&t.classList.add("btn--enabled"),t.classList.contains("user__logged--in")&&t.classList.remove("btn--enabled"),location.pathname.includes("index")&&informationAppLoggedOut.classList.add("section__fade--in"))}))}));